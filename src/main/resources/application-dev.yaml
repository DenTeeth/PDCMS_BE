# ============================================
# LOCAL DEVELOPMENT CONFIGURATION
# ============================================
# This file is activated when SPRING_PROFILES_ACTIVE=dev
# Use this profile when running application LOCALLY (not in Docker)
# ============================================

spring:
  # ==============================
  # Database Configuration (Local)
  # ==============================
  datasource:
    url: jdbc:postgresql://localhost:5432/${DB_DATABASE:dental_clinic_db}
    username: ${DB_USERNAME:root}
    password: ${DB_PASSWORD:123456}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 5
      minimum-idle: 2
      connection-timeout: 30000
      idle-timeout: 300000

  # ==============================
  # Redis Configuration (Local)
  # ==============================
  data:
    redis:
      host: localhost
      port: 6379
      password: ${REDIS_PASSWORD:redis123}

  # ==============================
  # JPA Configuration (Development)
  # ==============================
  jpa:
    hibernate:
      # DEV: Use 'create-drop' for clean DB on every restart
      # - Drops ALL tables on shutdown, recreates on startup
      # - Perfect for development with frequent schema changes
      # - Seed data is automatically loaded by SeedDataInitializer.java
      ddl-auto: create-drop
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        use_sql_comments: true

  # ==============================
  # SQL Init Configuration (Development)
  # ==============================
  # EXECUTION ORDER:
  #   1. schema-locations (enums.sql) runs BEFORE Hibernate - creates ENUMs
  #   2. Hibernate creates tables using existing ENUMs (ddl-auto: update)
  #   3. DataInitializer bean loads INSERT statements from seed-data.sql AFTER tables exist
  sql:
    init:
      mode: always
      schema-locations: classpath:db/enums.sql
      encoding: UTF-8
      continue-on-error: false
      separator: ";"

  # ==============================
  # Logging (Development)
  # ==============================
logging:
  level:
    org.springframework.web: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    com.example.dentalclinic: DEBUG

# ==============================
# Management/Actuator Configuration (Development)
# ==============================
management:
  health:
    mail:
      enabled: false  # Disable mail health check in development

# ==============================
# Application Configuration (Development)
# ==============================
app:
  frontend-url: ${FRONTEND_URL:http://localhost:3000}
  cors:
    # Allow localhost for development
    allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:5173,http://localhost:8080}

# ==============================
# Chatbot Configuration (Gemini AI)
# ==============================
chatbot:
  gemini:
    api-key: ${GEMINI_API_KEY:AIzaSyDdxkbfIBv0QNIeDvW3C6M0eQX_NiWNQNI}
    model-name: gemini-2.5-flash

# ==============================
# VietQR Configuration (for QR code generation)
# ==============================
# Generate QR: https://img.vietqr.io/image/<BANK_ID>-<ACCOUNT_NO>-<TEMPLATE>.png?amount=<AMOUNT>&addInfo=<DESCRIPTION>&accountName=<ACCOUNT_NAME>
# Example: https://img.vietqr.io/image/acb-24131687-compact2.jpg?amount=50000&addInfo=test&accountName=TRINH%20CONG%20THAI
vietqr:
  bank-id: ${VIETQR_BANK_ID:ACB}
  account-no: ${VIETQR_ACCOUNT_NO:24131687}
  account-name: ${VIETQR_ACCOUNT_NAME:TRINH CONG THAI}
  template: ${VIETQR_TEMPLATE:compact2}
